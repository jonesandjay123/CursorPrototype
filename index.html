<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>日文漢字讀音助手 | Kanji Furigana Annotator</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* 全局樣式 */
      :root {
        --primary-color: #4a6da7;
        --secondary-color: #f0f8ff;
        --accent-color: #ff6b6b;
        --text-color: #333;
        --light-text: #777;
        --border-color: #ddd;
        --success-color: #4caf50;
        --furigana-color: #4a6da7;
        --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        --border-radius: 8px;
        --phone-width: 375px;
        --phone-height: 812px;
        --phone-border: 15px;
        --phone-color: #111;
        --phone-radius: 36px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Noto Sans JP", "Noto Sans TC", "Hiragino Sans", sans-serif;
        color: var(--text-color);
        background-color: #f4f4f4;
        line-height: 1.6;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      /* 手機外殼樣式 */
      .phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        background-color: var(--phone-color);
        border-radius: var(--phone-radius);
        padding: var(--phone-border);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        position: relative;
        overflow: hidden;
        margin: 30px auto;
      }

      /* 手機劉海 */
      .phone-notch {
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 150px;
        height: 30px;
        background-color: var(--phone-color);
        border-bottom-left-radius: 15px;
        border-bottom-right-radius: 15px;
        z-index: 10;
      }

      /* 手機螢幕 */
      .phone-screen {
        width: 100%;
        height: 100%;
        background-color: white;
        border-radius: calc(var(--phone-radius) - var(--phone-border));
        overflow: hidden;
        position: relative;
      }

      /* 手機狀態欄 */
      .phone-status-bar {
        height: 35px;
        background-color: #f8f8f8;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 15px;
        font-size: 12px;
      }

      .phone-time {
        font-weight: bold;
      }

      .phone-status-icons {
        display: flex;
        gap: 5px;
      }

      /* 應用內容樣式 */
      .container {
        max-width: 100%;
        height: calc(100% - 35px);
        padding: 15px;
        overflow-y: auto;
      }

      /* 頭部樣式 */
      header {
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--border-color);
      }

      header h1 {
        color: var(--primary-color);
        font-size: 1.6rem;
        margin-bottom: 3px;
      }

      header .subtitle {
        color: var(--light-text);
        font-size: 0.9rem;
      }

      /* 主要內容區域 */
      main {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      /* 輸入區域 */
      .input-section {
        background-color: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 15px;
      }

      .input-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      textarea {
        width: 100%;
        height: 100px;
        padding: 12px;
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: 0.9rem;
        resize: vertical;
        font-family: inherit;
      }

      textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(74, 109, 167, 0.2);
      }

      .button-container {
        display: flex;
        gap: 8px;
      }

      button {
        padding: 8px 16px;
        border: none;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s ease;
      }

      .primary-button {
        background-color: var(--primary-color);
        color: white;
      }

      .primary-button:hover {
        background-color: #3a5d97;
      }

      .secondary-button {
        background-color: #f2f2f2;
        color: var(--text-color);
      }

      .secondary-button:hover {
        background-color: #e5e5e5;
      }

      /* 輸出控制區域 */
      .output-section {
        background-color: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 15px;
      }

      .output-controls {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border-color);
        flex-wrap: wrap;
        gap: 10px;
      }

      .toggle-container {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
      }

      .mode-selector {
        display: flex;
        gap: 3px;
      }

      .mode-button {
        background-color: #f2f2f2;
        color: var(--text-color);
        padding: 6px 12px;
        border-radius: var(--border-radius);
        font-size: 0.85rem;
      }

      .mode-button.active {
        background-color: var(--primary-color);
        color: white;
      }

      /* 切換開關樣式 */
      .switch {
        position: relative;
        display: inline-block;
        width: 46px;
        height: 24px;
      }

      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: 0.4s;
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: 0.4s;
      }

      input:checked + .slider {
        background-color: var(--primary-color);
      }

      input:focus + .slider {
        box-shadow: 0 0 1px var(--primary-color);
      }

      input:checked + .slider:before {
        transform: translateX(22px);
      }

      .slider.round {
        border-radius: 34px;
      }

      .slider.round:before {
        border-radius: 50%;
      }

      /* 結果容器 */
      .result-container {
        min-height: 180px;
      }

      .result-content {
        display: none;
      }

      .result-content.active {
        display: block;
      }

      .result-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
      }

      .result-header h3 {
        font-size: 1rem;
      }

      .result-actions {
        display: flex;
        gap: 8px;
      }

      .action-button {
        background-color: #f2f2f2;
        color: var(--text-color);
        padding: 6px;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 0.85rem;
      }

      .action-button:hover {
        background-color: #e5e5e5;
      }

      .annotated-content {
        background-color: var(--secondary-color);
        border-radius: var(--border-radius);
        padding: 15px;
        min-height: 120px;
        line-height: 2;
        font-size: 0.95rem;
      }

      .placeholder-text {
        color: var(--light-text);
        text-align: center;
        padding: 20px 0;
        font-size: 0.9rem;
      }

      /* 標註樣式 */
      .annotated-word {
        position: relative;
        display: inline-block;
        vertical-align: bottom;
        margin: 0 2px;
      }

      .furigana {
        position: absolute;
        bottom: 100%;
        left: 50%;
        transform: translateX(-50%);
        color: var(--furigana-color);
        font-size: 0.7em;
        white-space: nowrap;
        text-align: center;
        width: 100%;
      }

      .kanji {
        display: inline-block;
      }

      .romaji {
        display: none;
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        color: var(--light-text);
        font-size: 0.7em;
        white-space: nowrap;
        text-align: center;
        width: 100%;
      }

      /* 顯示羅馬拼音時的樣式 */
      body.show-romaji .romaji {
        display: block;
      }

      body.show-romaji .annotated-content {
        padding-bottom: 25px;
      }

      /* 分段模式樣式 */
      .paragraph-item {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        padding: 12px;
        background-color: var(--secondary-color);
        border-radius: var(--border-radius);
        margin-bottom: 12px;
      }

      .paragraph-text {
        flex: 1;
      }

      .paragraph-actions {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding-left: 8px;
      }

      .paragraph-placeholder {
        text-align: center;
        color: var(--light-text);
        padding: 20px 0;
        font-size: 0.9rem;
      }

      .hidden {
        display: none;
      }

      footer {
        text-align: center;
        font-size: 0.75rem;
        color: var(--light-text);
        margin-top: 20px;
        padding-top: 10px;
        border-top: 1px solid var(--border-color);
      }

      /* 針對特大屏幕的響應式調整 */
      @media (min-width: 1200px) {
        .phone-container {
          transform: scale(1.2);
          margin: 50px auto;
        }
      }

      /* 針對小屏幕的響應式調整 */
      @media (max-width: 400px) {
        :root {
          --phone-width: 100%;
          --phone-height: 100vh;
          --phone-border: 0;
          --phone-radius: 0;
        }

        .phone-container {
          margin: 0;
          box-shadow: none;
        }

        .phone-notch {
          display: none;
        }

        .phone-screen {
          border-radius: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="phone-container">
      <div class="phone-notch"></div>
      <div class="phone-screen">
        <div class="phone-status-bar">
          <div class="phone-time">14:30</div>
          <div class="phone-status-icons">
            <i class="fas fa-signal"></i>
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-three-quarters"></i>
          </div>
        </div>
        <div class="container">
          <header>
            <h1><i class="fas fa-language"></i> 日文漢字讀音助手</h1>
            <p class="subtitle">Kanji Furigana Annotator</p>
          </header>

          <main>
            <section class="input-section">
              <div class="input-container">
                <textarea
                  id="input-text"
                  placeholder="請輸入日文文本，例如歌詞或文章..."
                ></textarea>
                <div class="button-container">
                  <button id="annotate-button" class="primary-button">
                    <i class="fas fa-magic"></i> 標註假名
                  </button>
                  <button id="clear-button" class="secondary-button">
                    <i class="fas fa-eraser"></i> 清除
                  </button>
                </div>
              </div>
            </section>

            <section class="output-section">
              <div class="output-controls">
                <div class="toggle-container">
                  <span>顯示模式：</span>
                  <div class="mode-selector">
                    <button id="full-mode" class="mode-button active">
                      全篇
                    </button>
                    <button id="paragraph-mode" class="mode-button">
                      分段
                    </button>
                  </div>
                </div>
                <div class="toggle-container">
                  <span>羅馬拼音：</span>
                  <label class="switch">
                    <input type="checkbox" id="romaji-toggle" />
                    <span class="slider round"></span>
                  </label>
                </div>
              </div>

              <div class="result-container">
                <div id="full-content" class="result-content active">
                  <div class="result-header">
                    <h3>標註結果</h3>
                    <div class="result-actions">
                      <button id="play-all" class="action-button">
                        <i class="fas fa-play"></i>
                      </button>
                      <button id="copy-all" class="action-button">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                  </div>
                  <div id="annotated-text" class="annotated-content">
                    <p class="placeholder-text">標註結果將顯示在這裡...</p>
                    <!-- 示例標註內容 -->
                    <div class="example-result hidden">
                      <p class="annotated-line">
                        <span class="annotated-word">
                          <span class="furigana">わたし</span>
                          <span class="kanji">私</span>
                          <span class="romaji">watashi</span>
                        </span>
                        は
                        <span class="annotated-word">
                          <span class="furigana">にほん</span>
                          <span class="kanji">日本</span>
                          <span class="romaji">nihon</span>
                        </span>
                        <span class="annotated-word">
                          <span class="furigana">ご</span>
                          <span class="kanji">語</span>
                          <span class="romaji">go</span>
                        </span>
                        を
                        <span class="annotated-word">
                          <span class="furigana">べんきょう</span>
                          <span class="kanji">勉強</span>
                          <span class="romaji">benkyou</span>
                        </span>
                        しています。
                      </p>
                    </div>
                  </div>
                </div>

                <div id="paragraph-content" class="result-content">
                  <!-- 分段模式的內容將在標註後動態生成 -->
                  <div class="paragraph-placeholder">
                    <p>
                      選擇分段模式時，文本將按行分割，每行可以單獨播放或複製。
                    </p>
                  </div>
                  <!-- 示例分段內容 -->
                  <div class="example-paragraphs hidden">
                    <div class="paragraph-item">
                      <div class="paragraph-text">
                        <p class="annotated-line">
                          <span class="annotated-word">
                            <span class="furigana">わたし</span>
                            <span class="kanji">私</span>
                            <span class="romaji">watashi</span>
                          </span>
                          は
                          <span class="annotated-word">
                            <span class="furigana">にほん</span>
                            <span class="kanji">日本</span>
                            <span class="romaji">nihon</span>
                          </span>
                          <span class="annotated-word">
                            <span class="furigana">ご</span>
                            <span class="kanji">語</span>
                            <span class="romaji">go</span>
                          </span>
                          を
                          <span class="annotated-word">
                            <span class="furigana">べんきょう</span>
                            <span class="kanji">勉強</span>
                            <span class="romaji">benkyou</span>
                          </span>
                          しています。
                        </p>
                      </div>
                      <div class="paragraph-actions">
                        <button class="play-paragraph action-button">
                          <i class="fas fa-play"></i>
                        </button>
                        <button class="copy-paragraph action-button">
                          <i class="fas fa-copy"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
          </main>

          <footer>
            <p>&copy; 2023 日文漢字讀音助手 | Kanji Furigana Annotator</p>
          </footer>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // 獲取DOM元素
        const inputText = document.getElementById("input-text");
        const annotateButton = document.getElementById("annotate-button");
        const clearButton = document.getElementById("clear-button");
        const fullModeButton = document.getElementById("full-mode");
        const paragraphModeButton = document.getElementById("paragraph-mode");
        const romajiToggle = document.getElementById("romaji-toggle");
        const fullContent = document.getElementById("full-content");
        const paragraphContent = document.getElementById("paragraph-content");
        const annotatedText = document.getElementById("annotated-text");
        const playAllButton = document.getElementById("play-all");
        const copyAllButton = document.getElementById("copy-all");

        // 示例數據 - 在實際應用中，這些數據將從API獲取
        const sampleAnnotations = [
          {
            original: "私は日本語を勉強しています。",
            annotated:
              '<span class="annotated-word"><span class="furigana">わたし</span><span class="kanji">私</span><span class="romaji">watashi</span></span>は<span class="annotated-word"><span class="furigana">にほん</span><span class="kanji">日本</span><span class="romaji">nihon</span></span><span class="annotated-word"><span class="furigana">ご</span><span class="kanji">語</span><span class="romaji">go</span></span>を<span class="annotated-word"><span class="furigana">べんきょう</span><span class="kanji">勉強</span><span class="romaji">benkyou</span></span>しています。',
          },
          {
            original: "東京は日本の首都です。",
            annotated:
              '<span class="annotated-word"><span class="furigana">とうきょう</span><span class="kanji">東京</span><span class="romaji">tokyo</span></span>は<span class="annotated-word"><span class="furigana">にほん</span><span class="kanji">日本</span><span class="romaji">nihon</span></span>の<span class="annotated-word"><span class="furigana">しゅと</span><span class="kanji">首都</span><span class="romaji">shuto</span></span>です。',
          },
          {
            original: "桜の花が綺麗ですね。",
            annotated:
              '<span class="annotated-word"><span class="furigana">さくら</span><span class="kanji">桜</span><span class="romaji">sakura</span></span>の<span class="annotated-word"><span class="furigana">はな</span><span class="kanji">花</span><span class="romaji">hana</span></span>が<span class="annotated-word"><span class="furigana">きれい</span><span class="kanji">綺麗</span><span class="romaji">kirei</span></span>ですね。',
          },
        ];

        // 示例標註函數 - 在實際應用中將使用API進行標註
        function annotateText(text) {
          // 簡單的模擬標註 - 將輸入的文本與示例數據匹配
          const lines = text.trim().split("\n");
          const annotatedLines = [];

          lines.forEach((line) => {
            const trimmedLine = line.trim();
            if (!trimmedLine) {
              annotatedLines.push("");
              return;
            }

            // 尋找匹配的樣本
            const match = sampleAnnotations.find(
              (sample) => sample.original === trimmedLine
            );

            if (match) {
              annotatedLines.push(match.annotated);
            } else {
              // 假設無法標註的文本保持原樣
              annotatedLines.push(trimmedLine);
            }
          });

          return annotatedLines;
        }

        // 顯示標註結果
        function displayAnnotationResult(annotatedLines) {
          // 清除現有結果
          annotatedText.innerHTML = "";
          paragraphContent.innerHTML = "";

          // 檢查是否有內容
          if (
            annotatedLines.length === 0 ||
            (annotatedLines.length === 1 && !annotatedLines[0])
          ) {
            annotatedText.innerHTML =
              '<p class="placeholder-text">沒有內容可標註</p>';
            paragraphContent.innerHTML =
              '<div class="paragraph-placeholder"><p>沒有內容可標註</p></div>';
            return;
          }

          // 更新全篇模式內容
          const fullContentHtml = annotatedLines
            .map((line) =>
              line ? `<p class="annotated-line">${line}</p>` : "<br>"
            )
            .join("");
          annotatedText.innerHTML = fullContentHtml;

          // 更新分段模式內容
          const paragraphsHtml = annotatedLines
            .map((line) => {
              if (!line) return "";
              return `
              <div class="paragraph-item">
                <div class="paragraph-text">
                  <p class="annotated-line">${line}</p>
                </div>
                <div class="paragraph-actions">
                  <button class="play-paragraph action-button"><i class="fas fa-play"></i></button>
                  <button class="copy-paragraph action-button"><i class="fas fa-copy"></i></button>
                </div>
              </div>
            `;
            })
            .join("");

          paragraphContent.innerHTML = paragraphsHtml;

          // 為新增的按鈕添加事件監聽器
          document
            .querySelectorAll(".play-paragraph")
            .forEach((button, index) => {
              button.addEventListener("click", () => {
                playParagraph(annotatedLines[index]);
              });
            });

          document
            .querySelectorAll(".copy-paragraph")
            .forEach((button, index) => {
              button.addEventListener("click", () => {
                copyToClipboard(annotatedLines[index].replace(/<[^>]*>/g, ""));
                showCopyFeedback(button);
              });
            });
        }

        // TTS功能 - 在實際應用中將使用Web Speech API或其他TTS服務
        function playParagraph(text) {
          // 移除HTML標籤以獲取純文本
          const plainText = text.replace(/<[^>]*>/g, "");

          // 使用Web Speech API (目前僅在某些瀏覽器支持)
          if ("speechSynthesis" in window) {
            const utterance = new SpeechSynthesisUtterance(plainText);
            utterance.lang = "ja-JP"; // 設置為日語
            window.speechSynthesis.speak(utterance);
          } else {
            alert("您的瀏覽器不支持語音合成功能");
          }
        }

        // 複製文本到剪貼板
        function copyToClipboard(text) {
          navigator.clipboard.writeText(text).catch((err) => {
            console.error("無法複製文本: ", err);
          });
        }

        // 顯示複製成功反饋
        function showCopyFeedback(button) {
          const originalIcon = button.innerHTML;
          button.innerHTML = '<i class="fas fa-check"></i>';
          button.style.backgroundColor = "var(--success-color)";
          button.style.color = "white";

          setTimeout(() => {
            button.innerHTML = originalIcon;
            button.style.backgroundColor = "";
            button.style.color = "";
          }, 1500);
        }

        // 事件監聽器
        annotateButton.addEventListener("click", () => {
          const text = inputText.value.trim();
          if (!text) {
            alert("請輸入日文文本進行標註");
            return;
          }

          const annotatedLines = annotateText(text);
          displayAnnotationResult(annotatedLines);
        });

        clearButton.addEventListener("click", () => {
          inputText.value = "";
          annotatedText.innerHTML =
            '<p class="placeholder-text">標註結果將顯示在這裡...</p>';
          paragraphContent.innerHTML =
            '<div class="paragraph-placeholder"><p>選擇分段模式時，文本將按行分割，每行可以單獨播放或複製。</p></div>';
        });

        fullModeButton.addEventListener("click", () => {
          fullModeButton.classList.add("active");
          paragraphModeButton.classList.remove("active");
          fullContent.classList.add("active");
          paragraphContent.classList.remove("active");
        });

        paragraphModeButton.addEventListener("click", () => {
          paragraphModeButton.classList.add("active");
          fullModeButton.classList.remove("active");
          paragraphContent.classList.add("active");
          fullContent.classList.remove("active");
        });

        romajiToggle.addEventListener("change", () => {
          if (romajiToggle.checked) {
            document.body.classList.add("show-romaji");
          } else {
            document.body.classList.remove("show-romaji");
          }
        });

        playAllButton.addEventListener("click", () => {
          const text = annotatedText.textContent.trim();
          if (
            text &&
            text !== "標註結果將顯示在這裡..." &&
            text !== "沒有內容可標註"
          ) {
            playParagraph(text);
          }
        });

        copyAllButton.addEventListener("click", () => {
          const text = annotatedText.textContent.trim();
          if (
            text &&
            text !== "標註結果將顯示在這裡..." &&
            text !== "沒有內容可標註"
          ) {
            copyToClipboard(text);
            showCopyFeedback(copyAllButton);
          }
        });

        // 更新手機狀態欄時間
        function updateStatusBarTime() {
          const now = new Date();
          const hours = now.getHours().toString().padStart(2, "0");
          const minutes = now.getMinutes().toString().padStart(2, "0");
          document.querySelector(
            ".phone-time"
          ).textContent = `${hours}:${minutes}`;
        }

        // 初始化時更新時間並設置定時器
        updateStatusBarTime();
        setInterval(updateStatusBarTime, 60000); // 每分鐘更新一次
      });
    </script>
  </body>
</html>
